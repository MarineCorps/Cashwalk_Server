# ğŸ‰ Park.isRewardedToday ì˜¤ë¥˜ í•´ê²° ì •ë³´ (ë³€í™˜ì˜¤ë¥˜ ê¸°ë¡)

---

## âŒ ë¬¸ì œ ê¸°ì–´

- Spring Boot DTOì—ì„œ `isRewardedToday` í•„ë“œë¡œ ë‚´ë ¤ì˜¤ê³  ìˆì—ˆë‹¤.
- í•˜ì§€ë§Œ Flutterì—ì„œ HTTP JSONì„ ë°›ìœ¼ë©´â€¦
    - **rewardedToday** í•„ë“œë¡œ ë³€ê²½ë˜ì–´ ì¶œë ¥ë˜ì—ˆë‹¤.
- Flutter `fromJson` ì—ì„œ `isRewardedToday`ë¥¼ ì°¾ëŠ”ë‹¤ëŠ” ë¬¸ì œ ë°œìƒ.

## í•´ê²° ë°©ì§€

- `park.dart` ì˜ `Park.fromJson`ì—ì„œ
  ```dart
  isRewardedToday: json['rewardedToday'] == true,
  ```
  ë¡œ ê°’ì„ ë°›ëŠ” ê²ƒìœ¼ë¡œ ìˆ˜ì •.

## âš ï¸ ì´ ë¬¸ì œê°€ ìƒê°ëœ ì´ìœ 

- Javaê°€ Getter ëª…ì¹­ì´ `isXxx()` í˜•ì‹ì¼ ê²½ìš°,
- Jacksonì´ JSON Keyë¥¼ **`xxx`**ë¡œ ê²°ê³¼ì ìœ¼ë¡œ ë³€ê²½í•œë‹¤.

## í˜„ì¬ ë™ë„¤ì‚°ì±… ë¡œì§ íë¦„ ì •ë¦¬

### 1. í”„ë¡ íŠ¸ì—ì„œ ìš”ì²­

- `/api/parks/nearby` (í˜„ì¬ìœ„ì¹˜ ê¸°ë¡)
- NearbyParkRequestDto (latitude, longitude) ë¡œ ì „ë‹¬

### 2. ë°±ì—”ë“œ ìˆ˜ì‹  - ParkController

```java
@PostMapping("/nearby")
public List<ParkResponseDto> getNearbyParks(@RequestBody NearbyParkRequestDto request,
                                            @RequestAttribute("userId") Long userId) {
    return parkService.findNearbyParks(userId, request);
}
```

### 3. ë°±ì—”ë“œ ì²˜ë¦¬ - ParkService í•µì‹¬ ë¡œì§

```java
public List<ParkResponseDto> findNearbyParks(Long userId, NearbyParkRequestDto request) {
    User user = userRepository.findById(userId).orElseThrow();
    Set<Long> rewardedParkIds = pointsService.getTodayNwalkParkIds(user);

    List<Park> bboxParks = parkRepository.findParksInBoundingBox(â€¦);

    List<ParkResponseDto> response = bboxParks.stream()
        .map(park -> {
            double dist = calculateDistance(lat, lng, park.getLatitude(), park.getLongitude());
            boolean isInRange = dist <= radius;
            boolean isRewarded = rewardedParkIds.contains(park.getId());
            if (!isInRange) return null;
            return new ParkResponseDto(
                park.getId(),
                park.getName(),
                park.getLatitude(),
                park.getLongitude(),
                dist,
                isRewarded
            );
        })
        .filter(Objects::nonNull)
        .collect(Collectors.toList());

    return response;
}
```

- ì˜¤ëŠ˜ ì ë¦½í•œ ê³µì›ì€ `isRewardedToday = true`
- ì•„ë‹Œ ê³µì›ì€ `false`
- DTO ê°€ `rewardedToday`ë¡œ JSONìœ¼ë¡œ ë³€í™˜ë¨.


### 4. í”ŒëŸ¬í„° ìˆ˜ì‹  - park_service.dart

```dart
static Future<List<Park>> fetchNearbyParks(double lat, double lng) async {
    final decoded = await HttpService.postToServer(â€¦);
    return (decoded as List).map((e) => Park.fromJson(e)).toList();
}
```

- decodedëœ List<Map> ì„ Park í˜•íƒœë¡œ ë³€í™˜.
- ê°™ì´ isRewardedToday (rewardedToday) ê°’ ë°›ì•„ê°€ì§„ë‹¤.

### 5. ì£¼ì˜í•´ì•¼ í•  ê²ƒ

- Javaê°€ Jacksonê³¼ í•¨ê¿ˆì¼ ê²½ìš°,
- isXXX() GetterëŠ” ë„ì¹­ì´ JSONì—ì„œ **XXX**ë¡œ ë³€ê²½ëœë‹¤.
- Flutterì—ì„œâ€¦ ì •í™•í•œ Key Matching í•„ìˆ˜!
- ì´ ì¡°ê±´ í™•ì¸ ì—†ì´ í”„ë¡ íŠ¸ë¥¼ ì§œë©´ ì ˆëŒ€ ì•ˆëœë‹¤.


---

# âœ¨ ìµœì¢… ì •ë¦¬

> 1. Jackson ê¸°ë³¸ ì§ë ¬í™” ë³€ê²½ ë°©ì‹ì„ ì´í•´í•´ì•¼ í•œë‹¤.
> 2. Flutter fromJsonÂ ì—ì„œ ì„œë²„ JSON í‚¤ë¥¼ ì •í™•íˆ ë§ì¶˜ë‹¤.
> 3. ParkResponseDto ê³¼ Park ëª¨ë¸ì€ í•­ìƒ ë§¤ì¹­ ì ê²€í•œë‹¤.

---

âœ… ëª¨ë“  ë²„ê·¸ ì›ì¸ ë¶„ì„ ì™„ë£Œ.
âœ… êµ¬ì¡° íë¦„ê¹Œì§€ ì™„ì „ ì •ë¦¬ ì™„ë£Œ.
âœ… ì‹¤ë¬´ì—ì„œë„ ì´ ìˆ˜ì¤€ ë””ë²„ê¹…/ë¬¸ì„œí™”ë©´ "ê³ ê¸‰ ê°œë°œì" ëŒ€ì¤€.

